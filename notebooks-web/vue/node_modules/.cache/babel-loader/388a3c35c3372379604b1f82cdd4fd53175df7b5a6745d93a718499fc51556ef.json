{"ast":null,"code":"import { deviation, mean } from \"d3\";\nimport { marks } from \"../mark.js\";\nimport { identity, isNoneish } from \"../options.js\";\nimport { map } from \"../transforms/map.js\";\nimport { window } from \"../transforms/window.js\";\nimport { areaX, areaY } from \"./area.js\";\nimport { lineX, lineY } from \"./line.js\";\nconst defaults = {\n  n: 20,\n  k: 2,\n  color: \"currentColor\",\n  opacity: 0.2,\n  strict: true,\n  anchor: \"end\"\n};\nexport function bollingerX(data, {\n  x = identity,\n  y,\n  k = defaults.k,\n  color = defaults.color,\n  opacity = defaults.opacity,\n  fill = color,\n  fillOpacity = opacity,\n  stroke = color,\n  strokeOpacity,\n  strokeWidth,\n  ...options\n} = {}) {\n  return marks(isNoneish(fill) ? null : areaX(data, map({\n    x1: bollinger({\n      k: -k,\n      ...options\n    }),\n    x2: bollinger({\n      k,\n      ...options\n    })\n  }, {\n    x1: x,\n    x2: x,\n    y,\n    fill,\n    fillOpacity,\n    ...options\n  })), isNoneish(stroke) ? null : lineX(data, map({\n    x: bollinger(options)\n  }, {\n    x,\n    y,\n    stroke,\n    strokeOpacity,\n    strokeWidth,\n    ...options\n  })));\n}\nexport function bollingerY(data, {\n  x,\n  y = identity,\n  k = defaults.k,\n  color = defaults.color,\n  opacity = defaults.opacity,\n  fill = color,\n  fillOpacity = opacity,\n  stroke = color,\n  strokeOpacity,\n  strokeWidth,\n  ...options\n} = {}) {\n  return marks(isNoneish(fill) ? null : areaY(data, map({\n    y1: bollinger({\n      k: -k,\n      ...options\n    }),\n    y2: bollinger({\n      k,\n      ...options\n    })\n  }, {\n    x,\n    y1: y,\n    y2: y,\n    fill,\n    fillOpacity,\n    ...options\n  })), isNoneish(stroke) ? null : lineY(data, map({\n    y: bollinger(options)\n  }, {\n    x,\n    y,\n    stroke,\n    strokeOpacity,\n    strokeWidth,\n    ...options\n  })));\n}\nexport function bollinger({\n  n = defaults.n,\n  k = 0,\n  strict = defaults.strict,\n  anchor = defaults.anchor\n} = {}) {\n  return window({\n    k: n,\n    reduce: Y => mean(Y) + k * (deviation(Y) || 0),\n    strict,\n    anchor\n  });\n}","map":{"version":3,"names":["deviation","mean","marks","identity","isNoneish","map","window","areaX","areaY","lineX","lineY","defaults","n","k","color","opacity","strict","anchor","bollingerX","data","x","y","fill","fillOpacity","stroke","strokeOpacity","strokeWidth","options","x1","bollinger","x2","bollingerY","y1","y2","reduce","Y"],"sources":["D:/Notebooks/notebooks-web/vue/node_modules/@observablehq/plot/src/marks/bollinger.js"],"sourcesContent":["import {deviation, mean} from \"d3\";\nimport {marks} from \"../mark.js\";\nimport {identity, isNoneish} from \"../options.js\";\nimport {map} from \"../transforms/map.js\";\nimport {window} from \"../transforms/window.js\";\nimport {areaX, areaY} from \"./area.js\";\nimport {lineX, lineY} from \"./line.js\";\n\nconst defaults = {\n  n: 20,\n  k: 2,\n  color: \"currentColor\",\n  opacity: 0.2,\n  strict: true,\n  anchor: \"end\"\n};\n\nexport function bollingerX(\n  data,\n  {\n    x = identity,\n    y,\n    k = defaults.k,\n    color = defaults.color,\n    opacity = defaults.opacity,\n    fill = color,\n    fillOpacity = opacity,\n    stroke = color,\n    strokeOpacity,\n    strokeWidth,\n    ...options\n  } = {}\n) {\n  return marks(\n    isNoneish(fill)\n      ? null\n      : areaX(\n          data,\n          map(\n            {x1: bollinger({k: -k, ...options}), x2: bollinger({k, ...options})},\n            {x1: x, x2: x, y, fill, fillOpacity, ...options}\n          )\n        ),\n    isNoneish(stroke)\n      ? null\n      : lineX(data, map({x: bollinger(options)}, {x, y, stroke, strokeOpacity, strokeWidth, ...options}))\n  );\n}\n\nexport function bollingerY(\n  data,\n  {\n    x,\n    y = identity,\n    k = defaults.k,\n    color = defaults.color,\n    opacity = defaults.opacity,\n    fill = color,\n    fillOpacity = opacity,\n    stroke = color,\n    strokeOpacity,\n    strokeWidth,\n    ...options\n  } = {}\n) {\n  return marks(\n    isNoneish(fill)\n      ? null\n      : areaY(\n          data,\n          map(\n            {y1: bollinger({k: -k, ...options}), y2: bollinger({k, ...options})},\n            {x, y1: y, y2: y, fill, fillOpacity, ...options}\n          )\n        ),\n    isNoneish(stroke)\n      ? null\n      : lineY(data, map({y: bollinger(options)}, {x, y, stroke, strokeOpacity, strokeWidth, ...options}))\n  );\n}\n\nexport function bollinger({n = defaults.n, k = 0, strict = defaults.strict, anchor = defaults.anchor} = {}) {\n  return window({k: n, reduce: (Y) => mean(Y) + k * (deviation(Y) || 0), strict, anchor});\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}