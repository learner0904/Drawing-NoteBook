{"ast":null,"code":"import { isTemporal, labelof, map, maybeInterval, maybeValue, valueof } from \"../options.js\";\nimport { maybeInsetX, maybeInsetY } from \"./inset.js\";\n\n// The interval may be specified either as x: {value, interval} or as {x,\n// interval}. The former can be used to specify separate intervals for x and y,\n// for example with Plot.rect.\nfunction maybeIntervalValue(value, {\n  interval\n}) {\n  value = {\n    ...maybeValue(value)\n  };\n  value.interval = maybeInterval(value.interval === undefined ? interval : value.interval);\n  return value;\n}\nfunction maybeIntervalK(k, maybeInsetK, options, trivial) {\n  const {\n    [k]: v,\n    [`${k}1`]: v1,\n    [`${k}2`]: v2\n  } = options;\n  const {\n    value,\n    interval\n  } = maybeIntervalValue(v, options);\n  if (value == null || interval == null && !trivial) return options;\n  const label = labelof(v);\n  if (interval == null) {\n    let V;\n    const kv = {\n      transform: data => V || (V = valueof(data, value)),\n      label\n    };\n    return {\n      ...options,\n      [k]: undefined,\n      [`${k}1`]: v1 === undefined ? kv : v1,\n      [`${k}2`]: v2 === undefined && !(v1 === v2 && trivial) ? kv : v2\n    };\n  }\n  let D1, V1;\n  function transform(data) {\n    if (V1 !== undefined && data === D1) return V1; // memoize\n    return V1 = map(valueof(D1 = data, value), v => interval.floor(v));\n  }\n  return maybeInsetK({\n    ...options,\n    [k]: undefined,\n    [`${k}1`]: v1 === undefined ? {\n      transform,\n      label\n    } : v1,\n    [`${k}2`]: v2 === undefined ? {\n      transform: data => transform(data).map(v => interval.offset(v)),\n      label\n    } : v2\n  });\n}\nfunction maybeIntervalMidK(k, maybeInsetK, options) {\n  const {\n    [k]: v\n  } = options;\n  const {\n    value,\n    interval\n  } = maybeIntervalValue(v, options);\n  if (value == null || interval == null) return options;\n  return maybeInsetK({\n    ...options,\n    [k]: {\n      label: labelof(v),\n      transform: data => {\n        const V1 = map(valueof(data, value), v => interval.floor(v));\n        const V2 = V1.map(v => interval.offset(v));\n        return V1.map(isTemporal(V1) ? (v1, v2) => v1 == null || isNaN(v1 = +v1) || (v2 = V2[v2], v2 == null) || isNaN(v2 = +v2) ? undefined : new Date((v1 + v2) / 2) : (v1, v2) => v1 == null || (v2 = V2[v2], v2 == null) ? NaN : (+v1 + +v2) / 2);\n      }\n    }\n  });\n}\nexport function maybeTrivialIntervalX(options = {}) {\n  return maybeIntervalK(\"x\", maybeInsetX, options, true);\n}\nexport function maybeTrivialIntervalY(options = {}) {\n  return maybeIntervalK(\"y\", maybeInsetY, options, true);\n}\nexport function maybeIntervalX(options = {}) {\n  return maybeIntervalK(\"x\", maybeInsetX, options);\n}\nexport function maybeIntervalY(options = {}) {\n  return maybeIntervalK(\"y\", maybeInsetY, options);\n}\nexport function maybeIntervalMidX(options = {}) {\n  return maybeIntervalMidK(\"x\", maybeInsetX, options);\n}\nexport function maybeIntervalMidY(options = {}) {\n  return maybeIntervalMidK(\"y\", maybeInsetY, options);\n}","map":{"version":3,"names":["isTemporal","labelof","map","maybeInterval","maybeValue","valueof","maybeInsetX","maybeInsetY","maybeIntervalValue","value","interval","undefined","maybeIntervalK","k","maybeInsetK","options","trivial","v","v1","v2","label","V","kv","transform","data","D1","V1","floor","offset","maybeIntervalMidK","V2","isNaN","Date","NaN","maybeTrivialIntervalX","maybeTrivialIntervalY","maybeIntervalX","maybeIntervalY","maybeIntervalMidX","maybeIntervalMidY"],"sources":["D:/Notebooks/notebooks-web/vue/node_modules/@observablehq/plot/src/transforms/interval.js"],"sourcesContent":["import {isTemporal, labelof, map, maybeInterval, maybeValue, valueof} from \"../options.js\";\nimport {maybeInsetX, maybeInsetY} from \"./inset.js\";\n\n// The interval may be specified either as x: {value, interval} or as {x,\n// interval}. The former can be used to specify separate intervals for x and y,\n// for example with Plot.rect.\nfunction maybeIntervalValue(value, {interval}) {\n  value = {...maybeValue(value)};\n  value.interval = maybeInterval(value.interval === undefined ? interval : value.interval);\n  return value;\n}\n\nfunction maybeIntervalK(k, maybeInsetK, options, trivial) {\n  const {[k]: v, [`${k}1`]: v1, [`${k}2`]: v2} = options;\n  const {value, interval} = maybeIntervalValue(v, options);\n  if (value == null || (interval == null && !trivial)) return options;\n  const label = labelof(v);\n  if (interval == null) {\n    let V;\n    const kv = {transform: (data) => V || (V = valueof(data, value)), label};\n    return {\n      ...options,\n      [k]: undefined,\n      [`${k}1`]: v1 === undefined ? kv : v1,\n      [`${k}2`]: v2 === undefined && !(v1 === v2 && trivial) ? kv : v2\n    };\n  }\n  let D1, V1;\n  function transform(data) {\n    if (V1 !== undefined && data === D1) return V1; // memoize\n    return (V1 = map(valueof((D1 = data), value), (v) => interval.floor(v)));\n  }\n  return maybeInsetK({\n    ...options,\n    [k]: undefined,\n    [`${k}1`]: v1 === undefined ? {transform, label} : v1,\n    [`${k}2`]: v2 === undefined ? {transform: (data) => transform(data).map((v) => interval.offset(v)), label} : v2\n  });\n}\n\nfunction maybeIntervalMidK(k, maybeInsetK, options) {\n  const {[k]: v} = options;\n  const {value, interval} = maybeIntervalValue(v, options);\n  if (value == null || interval == null) return options;\n  return maybeInsetK({\n    ...options,\n    [k]: {\n      label: labelof(v),\n      transform: (data) => {\n        const V1 = map(valueof(data, value), (v) => interval.floor(v));\n        const V2 = V1.map((v) => interval.offset(v));\n        return V1.map(\n          isTemporal(V1)\n            ? (v1, v2) =>\n                v1 == null || isNaN((v1 = +v1)) || ((v2 = V2[v2]), v2 == null) || isNaN((v2 = +v2))\n                  ? undefined\n                  : new Date((v1 + v2) / 2)\n            : (v1, v2) => (v1 == null || ((v2 = V2[v2]), v2 == null) ? NaN : (+v1 + +v2) / 2)\n        );\n      }\n    }\n  });\n}\n\nexport function maybeTrivialIntervalX(options = {}) {\n  return maybeIntervalK(\"x\", maybeInsetX, options, true);\n}\n\nexport function maybeTrivialIntervalY(options = {}) {\n  return maybeIntervalK(\"y\", maybeInsetY, options, true);\n}\n\nexport function maybeIntervalX(options = {}) {\n  return maybeIntervalK(\"x\", maybeInsetX, options);\n}\n\nexport function maybeIntervalY(options = {}) {\n  return maybeIntervalK(\"y\", maybeInsetY, options);\n}\n\nexport function maybeIntervalMidX(options = {}) {\n  return maybeIntervalMidK(\"x\", maybeInsetX, options);\n}\n\nexport function maybeIntervalMidY(options = {}) {\n  return maybeIntervalMidK(\"y\", maybeInsetY, options);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}